{"version":3,"sources":["../../server/controllers/adminLoan.js"],"names":["require","getCurrentLoans","getRepaidLoans","getAllLoans","getSingleLoan","updateLoan","getloans","req","res","query","status","repaid","send","data","JSON","stringify","getSpecificLoan","loanID","params","loan","error","approveLoan","body","module","exports"],"mappings":"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","sourcesContent":["/* eslint-disable linebreak-style */\r\nconst {\r\n  getCurrentLoans, getRepaidLoans, getAllLoans, getSingleLoan, updateLoan,\r\n} = require('../helper/loansHelper');\r\n\r\nfunction getloans(req, res) {\r\n  if (req.query.status === 'approved' && req.query.repaid === 'false') {\r\n    res.status(200).send({\r\n      status: 200,\r\n      data: JSON.stringify(getCurrentLoans()),\r\n    });\r\n  } else if (req.query.status === 'approved' && req.query.repaid === 'true') {\r\n    res.status(200).send({\r\n      status: 200,\r\n      data: JSON.stringify(getRepaidLoans()),\r\n    });\r\n  } else {\r\n    res.status(200).send({\r\n      status: 200,\r\n      data: JSON.stringify(getAllLoans()),\r\n    });\r\n  }\r\n}\r\nfunction getSpecificLoan(req, res) {\r\n  const { loanID } = req.params;\r\n  if (loanID) {\r\n    const loan = getSingleLoan(loanID);\r\n    if (loan) {\r\n      res.status(200).send({\r\n        status: 200,\r\n        data: JSON.stringify(loan),\r\n      });\r\n    } else {\r\n      res.status(400).send({\r\n        status: 400,\r\n        error: 'We can\\'t find a loan with such ID',\r\n      });\r\n    }\r\n  } else {\r\n    res.status(400).send({\r\n      status: 400,\r\n      error: 'Bad request, please provide the loan ID = ',\r\n    });\r\n  }\r\n}\r\nfunction approveLoan(req, res) {\r\n  const loan = getSingleLoan(req.params.loanID);\r\n  if (loan) {\r\n    if (loan.status === 'approved') {\r\n      res.status(401).send({\r\n        status: 401,\r\n        error: 'you are not authorised to modify the status of this loan',\r\n      });\r\n    } else if (req.body.status === 'approved') {\r\n      loan.status = 'approved';\r\n      res.status(200).send({\r\n        status: 200,\r\n        data: JSON.stringify(updateLoan(loan)),\r\n      });\r\n    } else if (req.body.status === 'rejected') {\r\n      loan.status = 'rejected';\r\n      res.status(200).send({\r\n        status: 200,\r\n        data: JSON.stringify(updateLoan(loan)),\r\n      });\r\n    } else {\r\n      res.status(400).send({\r\n        status: 400,\r\n        error: 'Bad request, the new status is not correct ',\r\n      });\r\n    }\r\n  } else {\r\n    res.status(400).send({\r\n      status: 400,\r\n      error: 'Bad request, this loan does not exist ',\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  getSpecificLoan,\r\n  approveLoan,\r\n  getloans,\r\n};\r\n"],"file":"adminLoan.js"}